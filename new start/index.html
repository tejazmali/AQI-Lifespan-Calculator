<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Modern Tooltip Map</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Inter:400,300" rel="stylesheet">
  <style>
    /* Global Dark Theme */
    body {
      margin: 0;
      padding: 0;
      background-color: #030712;
      color: #FAFAFA;
      font-family: "Inter", sans-serif;
    }

    /* Container for the map and title */
    .map-container {
      width: 100%;
      max-width: 1200px;
      margin: 30px auto;
      padding: 40px 20px;
      box-sizing: border-box;
    }

    /* Heading with animation */
    .map-container h3 {
      font-size: 24px;
      margin-bottom: 8px;
      color: #ffffff;
      font-weight: normal;
      animation: fadeSlideIn 1s ease-out;
    }

    /* Paragraph animation (optional) */
    .map-container p {
      font-size: 14px;
      color: #aaaaaa;
      margin-bottom: 20px;
      animation: fadeSlideIn 1.5s ease-out;
    }

    /* Keyframes for fade and slide animation */
    @keyframes fadeSlideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Map div styling */
    #indian-map {
      width: 100%;
      height: 600px;
      background: #1e1e1e;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.5);
      position: relative;
    }

    /*
      CUSTOM TOOLTIP STYLES
      We create a div that we'll manually position so that its bottom center is aligned with the cursor.
    */
    #custom-tooltip {
      position: absolute;
      pointer-events: none; /* Mouse passes through */
      color: #ffffff;
      padding: 8px 12px;
      font-size: 14px;
      border-radius: 6px;
      background-color: #111827d7;
      backdrop-filter: blur(10px);
      opacity: 0;
      transition: all 0.25s ease;
      z-index: 9999; /* ensure on top */
    }

    /* Add a small arrow at the bottom of the tooltip */
    #custom-tooltip::after {
      content: "";
      position: absolute;
      bottom: -6px; /* adjust as needed */
      left: 50%;
      transform: translateX(-50%);
      border-width: 6px 6px 0 6px;
      border-style: solid;
      border-color: #2d2d2d transparent transparent transparent;
    }

    #custom-tooltip.show {
      opacity: 1;
    }

    svg path {
      transition: all 0.3s ease;
    }

    .custom-hover {
      fill: #ff6600 !important;
      transform: scale(1.05);
      filter: drop-shadow(2px 2px 5px rgba(0, 0, 0, 0.5));
    }
  </style>
</head>
<body>
  <div id="header"></div>
  <div class="map-container">
    <h3>Select a State</h3>
    <p>Click on any state in the map to view air pollution data.</p>
    <div id="indian-map">Loading map...</div>
  </div>

  <!-- The custom tooltip div (initially hidden) -->
  <div id="custom-tooltip"></div>
  <div id="footer"></div>

  <!-- FusionCharts Scripts -->
  <script src="https://static.fusioncharts.com/code/latest/fusioncharts.js"></script>
  <script src="https://static.fusioncharts.com/code/latest/fusioncharts.maps.js"></script>
  <script src="https://static.fusioncharts.com/code/latest/fusioncharts.india.js"></script>

  <script>
    // Mapping from state names to coordinates (for clicks)
    const stateCoordinates = {
      "Andhra Pradesh": "16.5417,80.5158",
      "Arunachal Pradesh": "27.0844,93.6053",
      "Assam": "26.1433,91.7898",
      "Bihar": "25.5941,85.1376",
      "Chhattisgarh": "21.2514,81.6296",
      "Goa": "15.4909,73.8278",
      "Gujarat": "23.2156,72.6369",
      "Haryana": "30.7333,76.7794",
      "Himachal Pradesh": "31.1048,77.1734",
      "Jharkhand": "23.3441,85.3096",
      "Karnataka": "12.9716,77.5946",
      "Kerala": "8.5241,76.9366",
      "Madhya Pradesh": "23.2599,77.4126",
      "Maharashtra": "19.0760,72.8777",
      "Manipur": "24.8170,93.9368",
      "Meghalaya": "25.5788,91.8933",
      "Mizoram": "23.7271,92.7176",
      "Nagaland": "25.6700,94.1100",
      "Odisha": "20.2961,85.8245",
      "Punjab": "30.7333,76.7794",
      "Rajasthan": "26.9124,75.7873",
      "Sikkim": "27.3389,88.6065",
      "Tamil Nadu": "13.0827,80.2707",
      "Telangana": "17.3850,78.4867",
      "Tripura": "23.8315,91.2868",
      "Uttar Pradesh": "26.8467,80.9462",
      "Uttarakhand": "30.3165,78.0322",
      "West Bengal": "22.5726,88.3639",
      "Delhi": "28.6139,77.2090",
      "Puducherry": "11.9416,79.8083"
    };

    function showTooltip(stateName, x, y) {
      const tooltip = document.getElementById('custom-tooltip');
      if (!tooltip) return;
      tooltip.innerHTML = stateName;
      tooltip.classList.add('show');
      const tooltipWidth = tooltip.clientWidth;
      const tooltipHeight = tooltip.clientHeight;
      const offsetY = 5; // gap between cursor and tooltip
      tooltip.style.left = (x - tooltipWidth / 2) + 'px';
      tooltip.style.top = (y - tooltipHeight - offsetY) + 'px';
    }

    function hideTooltip() {
      const tooltip = document.getElementById('custom-tooltip');
      if (!tooltip) return;
      tooltip.classList.remove('show');
    }

    document.addEventListener('mousemove', function(e) {
      const tooltip = document.getElementById('custom-tooltip');
      if (tooltip && tooltip.classList.contains('show')) {
        const offsetY = 5;
        tooltip.style.left = (e.pageX - tooltip.clientWidth / 2) + 'px';
        tooltip.style.top = (e.pageY - tooltip.clientHeight - offsetY) + 'px';
      }
    });

    FusionCharts.ready(function() {
      var indiaMap = new FusionCharts({
        type: "maps/india",
        renderAt: "indian-map",
        width: "100%",
        height: "100%",
        dataFormat: "json",
        dataSource: {
          "chart": {
            "bgColor": "#121212",
            "canvasBgColor": "#121212",
            "borderColor": "#2f2f2f",
            "entityFillColor": "#ffffff",
            "entityBorderColor": "#222222",
            "showToolTip": "0", // disable default tooltip
            "entityFillHoverColor": "ffffff",
            "caption": "",
            "subcaption": "",
            "showLegend": "0",
            "showLabels": "1",
            "showBorder": "1",
            "showCanvasBorder": "0",
            "legendBorderAlpha": "1",
            "nullEntityColor": "#888888"
          },
          "colorrange": {
            "minvalue": "0",
            "code": "#ffffff",
            "gradient": "0"
          },
          "data": []
        },
        events: {
          // Fired when hovering over a state
          "entityRollOver": function(evtObj, dataObj) {
            const stateElement = document.getElementById(dataObj.id);
            if (stateElement) {
              stateElement.classList.add("custom-hover");
            }
            showTooltip(dataObj.label, evtObj.clientX, evtObj.clientY);
          },
          // Fired when the cursor leaves a state
          "entityRollOut": function(evtObj, dataObj) {
            const stateElement = document.getElementById(dataObj.id);
            if (stateElement) {
              stateElement.classList.remove("custom-hover");
            }
            hideTooltip();
          },
          // Fired when a state is clicked
          "entityClick": function(evtObj, dataObj) {
            const stateName = dataObj.label;
            if (stateCoordinates[stateName]) {
              const coords = stateCoordinates[stateName].split(',');
              const lat = coords[0];
              const lon = coords[1];
              window.location.href = `details.html?state=${encodeURIComponent(stateName)}&lat=${encodeURIComponent(lat)}&lon=${encodeURIComponent(lon)}`;
            } else {
              alert("Coordinates not found for " + stateName);
            }
          }
        }
      }).render();
    });
  </script>
  <script src="/new start/script.js"></script>
</body>
</html>